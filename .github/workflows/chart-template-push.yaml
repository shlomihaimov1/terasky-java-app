name: Save Chart In Chart Museum

on:
 push:
   branches:
     - main
   paths:
     - 'appChart/**'

jobs:
 build:
   runs-on: self-hosted
   steps:
     - name: Checkout
       uses: actions/checkout@v2

     - name: Save Helm Chart to ChartMuseum
      #  run: |
      #   sudo helm package appChart/
      #   sudo curl --data-binary "@app-0.1.0.tgz" http://localhost:8080/api/charts?force=true
       uses: unwrittenmedia/helm3-push-action@v1.0.2
       env:
         SOURCE_DIR: '.'
         CHART_FOLDER: 'app'
         FORCE: 'True'
         CHARTMUSEUM_URL: 'http://localhost:8080'
         CHARTMUSEUM_USER: 'user'
         CHARTMUSEUM_PASSWORD: 'password'

